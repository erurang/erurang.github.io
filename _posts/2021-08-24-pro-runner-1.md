---
layout: post
title:  "Runner 개발과정 1"
subtitle: "Runner 개발과정 1"
categories: project
tags: runner
comments: true

---

## Runner프로젝트 개요

프론트 공부를 하던중.. 친구의 제안으로 러너 라는 프로젝트를 하게되었다.

앱을 만들건데, 리액트 네이티브로 화면을 구상해나가는 프론트 역할을 담당했다.

현재 앱의 구상은 주변의 사람들을 온라인으로 모아서 달리기를 통해 실시간으로 경쟁하는 시스템이다.

앞으로는 더 크게 나아간다곤 하는데.. 일단은 여기까지만 하는걸로 한다.

프론트는 React-native / apollo client 를 사용, 서버는 nest를 사용하며 api는 graphql로 정하였다.

db는 차차 정할생각이다.

![image](https://user-images.githubusercontent.com/56789064/130619441-32e154bf-2500-4256-bc6e-6902d4ec3985.png)

### 우여곡절..

1차로 `swift`나 `object-c`를 전혀 쓸생각이 없었던 나는 네이버 로그인 연동에서부터 막히기 시작했다.

`xcode`에서 뭘 그렇게 설정해야할게많은지.. 아예 무지한이라 그냥 이것저것 하나하나 다떄려박아보면서 연동시키는데만 거의 일주일이 걸렸다.

2차로.. 네이버 로그인은 성공적으로 됬는데.. 이 값으로 서버와 비교해서 프론트에 표시해야했던 나는 얄팍한 지식인 상태였다.

`graphql` 쓰면  `useQuery`로 요청하면 서버에서 값받아올수있잖아?~ 까지가 이 프로젝트를 진행하기전의 내 상태였다.

당장 문제가생긴게 ㅋㅋ 이메일을 받아와서 `makeVar`를 통해서 전역으로 상태를 관리하는 방식으로 만들었다.

```
네아로 라이브러리 로그인됨 -> 자 이제 중복체크를하자!
```

는 있을수없었다. 왜냐? `useQuery`가 컴포넌트 블럭 최상단에 위치해야하는것도 몰랐고, 네이버 로그인이 성공적으로 됫더라도 서버에서는 현재 중복된값인지 아닌지

받아올수가없었다.. 그래서 화면을 만들고 만들고 해서.. `props`를 넘기고 넘겨서 자체 상태를 변화시키는 방식으로 맨아래 컴포넌트에서 `useQuery`하는 방식을 썻는데.

이건 아닌거같았다. 아니다. 아니다는 확신이 너무들었다. 이건 너무 말이안되는 방식이였다.

그래서 다시생각했다. 네이버 라이브러리에서 `promise`로 토큰을 던져줄떄 이 토큰을 받아서 처리할 방법을...

아! `promise then`을 통해서 토큰을 받아오고 처리를 이어나가면 되겠다는 생각이들었다. 자 근데 여기서 문제가생겼다.

어짜피 네아로 함수내에서 `useQuery`를 내부에 선언하고 서버에서 값을 받아올수없었다. 왜? `useQuery`자체가 전역인 이유가잇을까?

그 이유는 쿼리가 업데이트되면 자동으로 컴포넌트를 업데이트하기떄문이다.

자 그럼 다음문제.. 나는 이 네이버로그인 라이브러리안에서 어떻게 만들어갈것인가?

아예 `axios(fetch)`를 통해서 서버로 데이터를 쏴서 받아오는 방식을 택했다. 아아 드디어 구현됬다.. 이틀동안 머리아팟던것이!!

하지만.. 나중에 더 찾아본결과 이런때를 대비해 `useLazyQuery`라는게 만들어져있다고 한다.. 

다음 개발때 `useLazyQuery`를 이용해서 개발 후 다음글로 찾아오겠다.

현재까지의 개발 깃허브 링크 : [running-app](https://github.com/erurang/running-app/tree/8ae4d079ff41c97e8ddc54401c6b1cf56360675e)